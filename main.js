!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isliked=e.isLiked,this._cardSelector=document.querySelector(t),this._handleCardClick=s,this._handleDeleteClick=r,this._handleLikeClick=i,this._element=this._cardSelector.content.querySelector(".card").cloneNode(!0),this._likeBtn=this._element.querySelector("#card__like-button"),this._deleteBtn=this._element.querySelector("#card__delete-button"),this._cardImage=this._element.querySelector("#card__image"),this._cardTitle=this._element.querySelector("#card__title")}setIsLiked(e){this._isLiked=e,this._handleLikeIcon()}isLiked(){return this._isLiked}_handleLikeIcon(){this._isLiked?this._likeBtn.classList.add("card__like-button_active"):this._likeBtn.classList.remove("card__like-button_active")}_setEventListeners(){this._likeBtn.addEventListener("click",(()=>{this._handleLikeClick(this._id)})),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteClick(this._id)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}getView(){return this._setEventListeners(),this._handleLikeIcon(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this._element}removeCard(){this._element.remove()}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputElements=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitBtn=this._formElement.querySelector(this._submitButtonSelector)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_toggleBtnState(){if(this._hasInvalidInput(this._inputElements))return this._submitBtn.classList.add(this._inactiveButtonClass),this._submitBtn.disabled=!0;this._submitBtn.classList.remove(this._inactiveButtonClass),this._submitBtn.disabled=!1}_showInputError(e){this._errorMessageElement=this._formElement.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._formElement.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}resetValidation(){this._toggleBtnState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleBtnState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._classSelector=document.querySelector(t)}addItem(e){this._classSelector.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}class r{constructor(e){this._popupEl=document.querySelector(e)}open(){this._popupEl.classList.add("popup_opened"),document.addEventListener("keydown",this._closeByEscape)}close(){this._popupEl.classList.remove("popup_opened"),document.removeEventListener("keydown",this._closeByEscape)}_closeByEscape=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupEl.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close(),e.target.classList.contains("popup__close")&&this.close()}))}}class i extends r{constructor(e,t){super(e),this._popupForm=this._popupEl.querySelector(".popup__form"),this._submitBtn=this._popupForm.querySelector(".popup__save"),this._handleFormSubmit=t,this._inputs=this._popupForm.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{const e=this._getInputValues();this._handleFormSubmit(e)}))}close(){this._popupForm.reset(),super.close()}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}renderLoading(e,t){e&&(this._submitBtn.textContent="Saving..."),e||(this._submitBtn.textContent=t)}}const n=document.querySelector("#profile__edit-button"),o=document.querySelector("#profile__add-button"),a=document.querySelector(".profile__image-edit"),l={};var h;h={inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible",formSelector:".popup__form"},Array.from(document.querySelectorAll(h.formSelector)).forEach((e=>{const s=new t(h,e),r=e.getAttribute("name");l[r]=s,s.enableValidation()}));const c=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUsersInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkServerResponse)}getCardList(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkServerResponse)}getAPIInfo(){return Promise.all([this.getUsersInfo(),this.getCardList()])}editProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkServerResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkServerResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}addCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkServerResponse)}removeCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkServerResponse)}editProfilePhoto(e){return fetch(`${this._baseUrl}/users/me/avatar `,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6d3d8659-087c-48a4-9b8b-b1f3f711b21d","Content-Type":"application/json"}}),_=new class{constructor(e,t,s){this._name=document.querySelector(e),this._job=document.querySelector(t),this._avatar=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}getUserPhoto(){return{avatar:this._avatar.src}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}setUserPhoto(e){this._avatar.src=e.avatar}}("#profile__name","#profile__description","#profile__image"),d=new i("#profile-popup",(e=>{!function(e){d.renderLoading(!0,"Save"),c.editProfile(e).then((e=>{_.setUserInfo(e),d.close()})).catch((e=>{console.log(e)})).finally((()=>{d.renderLoading(!1,"Save")}))}(e)})),u=new i("#photo-add-popup",(e=>{!function(e){u.renderLoading(!0,"Create"),c.addNewCard(e).then((e=>{const t=E(e);L.addItem(t),u.close()})).catch((e=>{console.log(e)})).finally((()=>{u.renderLoading(!1,"Create")}))}(e)})),p=new i("#profile-photo-popup",(e=>{!function(e){p.renderLoading(!0,"Save"),c.editProfilePhoto(e).then((e=>{_.setUserPhoto(e),p.close()})).catch((e=>{console.log(e)})).finally((()=>{p.renderLoading(!1,"Save")}))}(e)})),m=new class extends r{constructor(e){super(e),this._title=this._popupEl.querySelector(".popup__title"),this._image=this._popupEl.querySelector(".popup__full-photo")}open(e){super.open(),this._image.src=e.link,this._image.alt=e.name,this._title.textContent=e.name}}("#full-photo-popup"),v=new class extends r{constructor(e){super(e),this._popupForm=this._popupEl.querySelector(".popup__form"),this._deleteBtn=this._popupEl.querySelector(".popup__save")}setSubmitAction(e){this._handleFormSubmit=e}renderLoading(e){this._deleteBtn.textContent=e?"Saving...":"Yes"}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{this._handleFormSubmit(e)}))}}("#photo-delete-popup");function E(t){const s=new e(t,"#card-template",(e=>{m.open(e)}),(e=>{v.open(),v.setSubmitAction((()=>{v.renderLoading(!0),c.deleteCard(e).then((()=>{s.removeCard(e),v.close()})).catch((e=>{console.log(e)})).finally((()=>{v.renderLoading(!1)}))}))}),(e=>{s.isLiked()?c.removeCardLike(e).then((e=>s.setIsLiked(e.isLiked))).catch((e=>console.log(e))):c.addCardLike(e).then((e=>s.setIsLiked(e.isLiked))).catch((e=>console.log(e)))}));return s.getView()}let L;c.getAPIInfo().then((e=>{let[t,r]=e;_.setUserInfo(t),_.setUserPhoto(t),L=new s({items:r,renderer:e=>{const t=E(e);L.addItem(t)}},"#gallery__cards"),L.renderItems()})).catch((e=>{console.log(e)})),d.setEventListeners(),u.setEventListeners(),m.setEventListeners(),p.setEventListeners(),v.setEventListeners(),n.addEventListener("click",(()=>{const{name:e,about:t}=_.getUserInfo();d.setInputValues({name:e,about:t}),d.open(),l.profile_form.resetValidation()})),o.addEventListener("click",(()=>{u.open(),l.photo_form.resetValidation()})),a.addEventListener("click",(()=>{p.open(),l.profile_photo_form.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQVEwRCxFQUFZbEssV0FBV3dHLEVBQUl0SCxXQUN6QzRKLE9BQU9DLEdBQVFDLFFBQVFDLElBQUlGLElBQ2hDLElBR0osT0FBT21CLEVBQVkxSixTQUNyQixDQU9BLElBQUkrSSxFQUNKckQsRUFDR2lCLGFBQ0FGLE1BQUs5RCxJQUFzQixJQUFwQmdILEVBQVNDLEdBQU1qSCxFQUNyQmdGLEVBQVNRLFlBQVl3QixHQUNyQmhDLEVBQVNTLGFBQWF1QixHQUN0QlosRUFBVSxJQUFJckcsRUFDWixDQUNFRyxNQUFPK0csRUFDUDlHLFNBQVd3RyxJQUNULE1BQU1ULEVBQVVDLEVBQVdRLEdBQzNCUCxFQUFRN0YsUUFBUTJGLEVBQVEsR0FHNUIsbUJBRUZFLEVBQVExRixhQUFhLElBRXRCaUYsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQU9wQkYsRUFBVXRFLG9CQUNWNkUsRUFBUzdFLG9CQUNUb0YsRUFBV3BGLG9CQUNYa0YsRUFBWWxGLG9CQUNad0YsRUFBWXhGLG9CQUdabUIsRUFBZW5GLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU0sS0FBRTFCLEVBQUksTUFBRTZJLEdBQVVTLEVBQVNNLGNBQ2pDSSxFQUFVdkQsZUFBZSxDQUFFekcsT0FBTTZJLFVBQ2pDbUIsRUFBVTNFLE9BQ1YyQixFQUE2QixhQUFFaEQsaUJBQWlCLElBSWxEOEMsRUFBWXBGLGlCQUFpQixTQUFTLEtBQ3BDNkksRUFBU2xGLE9BQ1QyQixFQUEyQixXQUFFaEQsaUJBQWlCLElBSWhEK0MsRUFBYXJGLGlCQUFpQixTQUFTLEtBQ3JDa0osRUFBWXZGLE9BQ1oyQixFQUFtQyxtQkFBRWhELGlCQUFpQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgICAvLyByZW1vdmVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2lzbGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICAgIC8vIHRoaXMuX3JlbW92ZUxpa2VDbGljayA9IHJlbW92ZUxpa2VDbGljaztcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fY2FyZFNlbGVjdG9yLmNvbnRlbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5fbGlrZUJ0biA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ0biA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfX3RpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gY2FsbCB0aGlzIG1ldGhvZCBmcm9tIGluZGV4LmpzIGFmdGVyIHN1Y2Nlc3NmdWwgYXBpIHJlc3BvbnNlIGluIGB0aGVuYCBibG9ja1xyXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICAvLyB0aGlzLl9hZGRMaWtlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICAvLyB0aGlzLl9yZW1vdmVMaWtlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gI2NhcmRfX2xpa2UtYnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCk7XHJcbiAgICB9KTtcclxuICAgIC8vICNjYXJkX19kZWxldGUtYnV0dG9uXHJcbiAgICB0aGlzLl9kZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgICAvLyAjZnVsbC1waG90by1wb3B1cFxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICAvLyBzZXQgZXZlbnQgbGlzdGVuZXJcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAvLyByZXR1cm4gdGhlIGNhcmRcclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdG5TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbGVtZW50cykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHJldHVybiAodGhpcy5fc3VibWl0QnRuLmRpc2FibGVkID0gdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpe1xyXG4gICAgdGhpcy5fdG9nZ2xlQnRuU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ0blN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NsYXNzU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jbGFzc1NlbGVjdG9yLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIC8vIFRoZSBjb25zdHJ1Y3RvciBoYXMgYSBzaW5nbGUgcGFyYW1ldGVyLCB3aGljaCBpcyB0aGUgcG9wdXAgc2VsZWN0b3IuXHJcbiAgICB0aGlzLl9wb3B1cEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIC8vIG9wZW4oKSBhbmQgY2xvc2UoKSB0aGF0IHdpbGwgb3BlbiBhbmQgY2xvc2UgdGhlIHBvcHVwLlxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9jbG9zZUJ5RXNjYXBlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICAvLyBfaGFuZGxlRXNjQ2xvc2UoKSBmb3IgY2xvc2luZyB0aGUgcG9wdXAgYnkgcHJlc3NpbmcgdGhlIEVzYyBrZXkuXHJcbiAgX2Nsb3NlQnlFc2NhcGUgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gc2V0RXZlbnRMaXN0ZW5lcnMoKSB0aGF0IGFkZHMgYSBldmVudCBsaXN0ZW5lciB0byBjbG9zZSB0aGUgcG9wdXAgd2hlbiBjbGlja2VkIG92ZXJsYXkgb3IgY2xvc2UgYnV0dG9uXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICAvLyBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZVwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAvLyAgIHRoZSBwb3B1cCBzZWxlY3RvciwgYW5kIGEgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggUG9wdXBXaXRoRm9ybSBjYWxscyB3aGVuIHRoZSBmb3Jt4oCZcyBzdWJtaXQgZXZlbnQgZmlyZXNcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWwucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlXCIpO1xyXG4gICAgLy8gdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gICBjb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdC5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dE9iaiA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0T2JqW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dE9iajtcclxuICB9XHJcblxyXG4gIC8vICAgYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybSBhbmQgdGhlIGNsaWNrIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyAgIHRvIHJlc2V0IHRoZSBmb3JtIG9uY2UgdGhlIHBvcHVwIGlzIGNsb3NlZC5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIC8vIHNldCB1c2VyIGluZm9ybWF0aW9uIHRvIGZvcm1cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyByZW5kZXIgbG9hZGluZyBtZXNzYWdlXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGRlZmF1bHRUZXh0KSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9XHJcbiAgICBpZiAoIWlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgRWxlbWVudHMgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLy8gY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbi8vICAgfSxcclxuLy8gXTtcclxuXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3NhdmVcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxufTtcclxuXHJcbi8vIEJ1dHRvblxyXG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHBob3RvQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlUGhvdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWVkaXRcIik7XHJcblxyXG5leHBvcnQgeyBjb25maWcsIHByb2ZpbGVFZGl0QnRuLCBwaG90b0FkZEJ0biwgcHJvZmlsZVBob3RvIH07XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNvbmZpZyxcclxuICBwcm9maWxlRWRpdEJ0bixcclxuICBwaG90b0FkZEJ0bixcclxuICBwcm9maWxlUGhvdG8sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICBGb3JtIFZhbGlkYXRpb24gICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcbi8vIGVuYWJsZSB2YWxpZGF0aW9uXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcclxuICAgIC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgZm9ybVxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cclxuICAgIC8vIHN0b3JlIGEgdmFsaWRhdG9yIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGZvcm1cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgQ2xhc3MgSW5zdGFuY2VzICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI2ZDNkODY1OS0wODdjLTQ4YTQtOWI4Yi1iMWYzZjcxMWIyMWRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgXCIjcHJvZmlsZV9fbmFtZVwiLFxyXG4gIFwiI3Byb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgXCIjcHJvZmlsZV9faW1hZ2VcIlxyXG4pO1xyXG5cclxuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1wb3B1cFwiLCAob2JqKSA9PiB7XHJcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQob2JqKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Bob3RvLWFkZC1wb3B1cFwiLCAob2JqKSA9PiB7XHJcbiAgaGFuZGxlUGhvdG9BZGRTdWJtaXQob2JqKTtcclxufSk7XHJcblxyXG5jb25zdCBjaGFuZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtcGhvdG8tcG9wdXBcIiwgKG9iaikgPT4ge1xyXG4gIGhhbmRsZVByb2ZpbGVQaG90b1N1Ym1pdChvYmopO1xyXG59KTtcclxuXHJcbmNvbnN0IHBob3RvUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjZnVsbC1waG90by1wb3B1cFwiKTtcclxuXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNwaG90by1kZWxldGUtcG9wdXBcIik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICBGdW5jdGlvbnMgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChvYmopIHtcclxuICBlZGl0UG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmVcIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGUob2JqKVxyXG4gICAgLnRoZW4oKG9iaikgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhvYmopO1xyXG4gICAgICBlZGl0UG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQaG90b0FkZFN1Ym1pdChvYmopIHtcclxuICBhZGRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiQ3JlYXRlXCIpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQob2JqKVxyXG4gICAgLnRoZW4oKG9iaikgPT4ge1xyXG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZChvYmopO1xyXG4gICAgICBzZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XHJcbiAgICAgIGFkZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiQ3JlYXRlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVQaG90b1N1Ym1pdChvYmopIHtcclxuICBjaGFuZ2VQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiU2F2ZVwiKTtcclxuICBhcGlcclxuICAgIC5lZGl0UHJvZmlsZVBob3RvKG9iailcclxuICAgIC50aGVuKChvYmopID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlclBob3RvKG9iaik7XHJcbiAgICAgIGNoYW5nZVBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNoYW5nZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBjcmVhdGUgY2FyZCBlbGVtZW50XHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgICAoY2FyZERhdGEpID0+IHtcclxuICAgICAgcGhvdG9Qb3B1cC5vcGVuKGNhcmREYXRhKTtcclxuICAgIH0sXHJcbiAgICAoY2FyZElkKSA9PiB7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICAgICAgLy8gZGVsZXRlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKSxcclxuICAgICAgZGVsZXRlUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBkZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmVDYXJkKGNhcmRJZCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIChjYXJkSWQpID0+IHtcclxuICAgICAgaWYgKGNhcmRFbGVtZW50LmlzTGlrZWQoKSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZUNhcmRMaWtlKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IGNhcmRFbGVtZW50LnNldElzTGlrZWQocmVzLmlzTGlrZWQpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZENhcmRMaWtlKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IGNhcmRFbGVtZW50LnNldElzTGlrZWQocmVzLmlzTGlrZWQpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICBJbml0aWFsIEluZm8gICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuLy8gbG9hZCBjYXJkIGxpc3QgYW5kIHVzZXIgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgYW5kIHJlbmRlciB0aGVtXHJcbmxldCBzZWN0aW9uO1xyXG5hcGlcclxuICAuZ2V0QVBJSW5mbygpXHJcbiAgLnRoZW4oKFtwcm9maWxlLCBjYXJkc10pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHByb2ZpbGUpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlclBob3RvKHByb2ZpbGUpO1xyXG4gICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIiNnYWxsZXJ5X19jYXJkc1wiXHJcbiAgICApO1xyXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgIEV2ZW50IExpc3RuZXIgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vLyBlbmVibGUgZXZlbnQgbGlzdGVuZXJzIGluIGVhY2ggZm9ybVxyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucGhvdG9Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jaGFuZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gaGFuZGxlIHRoZSBwcm9maWxlIGVkaXQgcG9wdXBcclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGVkaXRQb3B1cC5zZXRJbnB1dFZhbHVlcyh7IG5hbWUsIGFib3V0IH0pO1xyXG4gIGVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlX2Zvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuLy8gaGFuZGxlIHRoZSBwaG90byBhZGQgcG9wdXBcclxucGhvdG9BZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRQb3B1cC5vcGVuKCk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwaG90b19mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbi8vIGhhbmRsZSB0aGUgcHJvZmlsZSBwaG90byBjaGFuZ2UgcG9wdXBcclxucHJvZmlsZVBob3RvLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2hhbmdlUG9wdXAub3BlbigpO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZV9waG90b19mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1NlcnZlclJlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFVzZXJzSW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldENhcmRMaXN0KCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QVBJSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2Vyc0luZm8oKSwgdGhpcy5nZXRDYXJkTGlzdCgpXSk7XHJcbiAgfVxyXG5cclxuICBlZGl0UHJvZmlsZShvYmopIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBvYmoubmFtZSxcclxuICAgICAgICBhYm91dDogb2JqLmFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKG9iaikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogb2JqLm5hbWUsXHJcbiAgICAgICAgbGluazogb2JqLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFByb2ZpbGVQaG90byhvYmopIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXIgYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogb2JqLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRvcnNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRvcnNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIC8vICAgcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlciB0byBkaXNwbGF5IHRoZSB1c2VyIGRhdGEgaW4gdGhlIG9wZW4gZm9ybS5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fam9iLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICAgIHJldHVybiB1c2VySW5mbztcclxuICB9XHJcblxyXG4gIGdldFVzZXJQaG90bygpIHtcclxuICAgIGNvbnN0IHVzZXJJbmZvID0geyBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmMgfTtcclxuICAgIHJldHVybiB1c2VySW5mbztcclxuICB9XHJcblxyXG4gIC8vICAgdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cclxuICBzZXRVc2VySW5mbyhvYmopIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBvYmoubmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IG9iai5hYm91dDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJQaG90byhvYmopIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBvYmouYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wb3B1cEVsLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Z1bGwtcGhvdG9cIik7XHJcbiAgfVxyXG4gIC8vICAgYWRkIGFuIGltYWdlIHRvIHRoZSBwb3B1cCBhbmQgdGhlIGNvcnJlc3BvbmRpbmcgaW1hZ2Ugc3JjIGF0dHJpYnV0ZSBhbG9uZyB3aXRoIGEgY2FwdGlvbiBmb3IgdGhlIGltYWdlLlxyXG4gIG9wZW4oY2FyZERhdGEpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9wb3B1cEVsLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3NhdmVcIik7XHJcbiAgICAvLyB0aGlzLl9kZWxldGVCdG5UZXh0ID0gdGhpcy5fZGVsZXRlQnRuLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgLy9cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUJ0bi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIGFkZCB0aGUgc3VibWl0IGV2ZW50IGhhbmRsZXIgdG8gdGhlIGJ1dHRvbiBhbmQgdGhlIGNsaWNrIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKG9iaikgPT4ge1xyXG4gICAgICAvLyAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KG9iaik7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNsaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfbGlrZUJ0biIsIl9kZWxldGVCdG4iLCJfY2FyZEltYWdlIiwiX2NhcmRUaXRsZSIsInNldElzTGlrZWQiLCJfaXNMaWtlZCIsIl9oYW5kbGVMaWtlSWNvbiIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJnZXRWaWV3Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJyZW1vdmVDYXJkIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0RWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ0biIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfdG9nZ2xlQnRuU3RhdGUiLCJkaXNhYmxlZCIsIl9zaG93SW5wdXRFcnJvciIsIl9lcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiZXZ0IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiU2VjdGlvbiIsIl9yZWYiLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jbGFzc1NlbGVjdG9yIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWwiLCJvcGVuIiwiX2Nsb3NlQnlFc2NhcGUiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dE9iaiIsImlucHV0IiwidmFsdWUiLCJpbnB1dFZhbHVlcyIsInJlc2V0Iiwic2V0SW5wdXRWYWx1ZXMiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJwcm9maWxlRWRpdEJ0biIsInBob3RvQWRkQnRuIiwicHJvZmlsZVBob3RvIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtU2VsZWN0b3IiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1NlcnZlclJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJzSW5mbyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImdldENhcmRMaXN0IiwiZ2V0QVBJSW5mbyIsImFsbCIsImVkaXRQcm9maWxlIiwib2JqIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkQ2FyZExpa2UiLCJyZW1vdmVDYXJkTGlrZSIsImVkaXRQcm9maWxlUGhvdG8iLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRvcnNlbGVjdG9yIiwiX2pvYiIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsImdldFVzZXJQaG90byIsInNldFVzZXJJbmZvIiwic2V0VXNlclBob3RvIiwiZWRpdFBvcHVwIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImhhbmRsZVByb2ZpbGVFZGl0U3VibWl0IiwiYWRkUG9wdXAiLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsInNlY3Rpb24iLCJoYW5kbGVQaG90b0FkZFN1Ym1pdCIsImNoYW5nZVBvcHVwIiwiaGFuZGxlUHJvZmlsZVBob3RvU3VibWl0IiwicGhvdG9Qb3B1cCIsIl90aXRsZSIsIl9pbWFnZSIsImNhcmREYXRhIiwiZGVsZXRlUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iLCJjYXJkRWxlbWVudCIsInByb2ZpbGUiLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=